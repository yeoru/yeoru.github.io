<!DOCTYPE html>
<html>
<head>
<style>
/* CSS 코드 */

body {
  background-color: rgb(31, 31, 32);
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  margin: 0;
}

#text-input {
  /* 가운데 정렬 스타일 */
  width: 300px; /* 원하는 너비 지정 */
  background-color: rgb(228, 228, 228);
  stroke: rgb(31, 31, 32);
  padding: 10px;
  font-size: 16px;
}

#add-button {
  /* 버튼 높이 설정 */
  height: 40px;
  background-color: rgb(228, 228, 228);
  color: rgb(255, 255, 255);
}


@keyframes float {
  0% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-20px);
  }
  100% {
    transform: translateY(0);
  }
}

.float-text {
  animation: float 3s infinite; 
  position: random;
  color: rgb(38, 198, 204); 
}

</style>

</head>
<body>
<input type="text" id="text-input"  placeholder="당신이 현재 강력히 원하는 것은 무엇인가요?">
<button id="add-button" onclick="addFloatingText()">  추가</button>
<div id="floating-text-container"></div>
<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-analytics.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyAas6a-M09tPLHu5p5C37RO_BmY_WnOF0I",
    authDomain: "yyyy-9ed04.firebaseapp.com",
    projectId: "yyyy-9ed04",
    storageBucket: "yyyy-9ed04.appspot.com",
    messagingSenderId: "1017106848865",
    appId: "1:1017106848865:web:06ec096dabd4c0a427de20",
    measurementId: "G-J7J2931TC8"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
  async function selectData(collectionName) {
  try {
    const querySnapshot = await getDocs(collection(db, collectionName));
    querySnapshot.forEach((doc) => {
      console.log("Document data:", doc.data());
    });
  } catch (error) {
    console.error("Error selecting documents: ", error);
  }
}

</script>
<script>
// JavaScript 코드
function addFloatingText() {
  addTextFromInput();
}

function addTextFromInput() {
  const textInput = document.getElementById("text-input");
  const text = textInput.value;
  
  if (text) {
    const floatingText = document.createElement("div");
    floatingText.className = "float-text";
    floatingText.innerText = text;
    
    document.getElementById("floating-text-container").appendChild(floatingText);
    
    textInput.value = "";

    // 클라이언트 측에서 서버로 문장을 전송
    sendDataToServer(text);
  }
}

function sendDataToServer(text) {
  fetch('/addSentence', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({ sentence: text }),
  })
  .then(response => {
    if (response.status === 200) {
      console.log('문장이 서버에 저장되었습니다.');
    } else {
      console.error('서버에 문장 저장 중 오류가 발생했습니다.');
    }
  })
  .catch(error => {
    console.error('서버 통신 중 오류가 발생했습니다.', error);
  });
}

function getSentencesAndDisplay() {
  fetch('/getSentences')
  .then(response => response.json())
  .then(sentences => {
    const container = document.getElementById("floating-text-container");
    sentences.forEach(sentence => {
      const floatingText = document.createElement("div");
      floatingText.className = "float-text";
      floatingText.innerText = sentence;
      container.appendChild(floatingText);
    });
  })
  .catch(error => {
    console.error('서버에서 문장을 가져오는 중 오류가 발생했습니다.', error);
  });
}

// Enter 키를 눌렀을 때 처리
document.getElementById("text-input").addEventListener("keydown", function (event) {
  if (event.key === "Enter") {
    addTextFromInput();
  }
});

// 페이지가 로드될 때 저장된 문장을 가져와 화면에 띄우기
getSentencesAndDisplay();
</script>
</body>
</html>